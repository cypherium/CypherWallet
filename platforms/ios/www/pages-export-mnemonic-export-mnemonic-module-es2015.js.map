{"version":3,"sources":["./src/app/pages/export-mnemonic/export-mnemonic.page.html","./src/app/pages/export-mnemonic/export-mnemonic.module.ts","./src/app/pages/export-mnemonic/export-mnemonic.page.scss","./src/app/pages/export-mnemonic/export-mnemonic.page.ts"],"names":[],"mappings":"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","file":"pages-export-mnemonic-export-mnemonic-module-es2015.js","sourcesContent":["export default \"<ion-header>\\n    <ion-toolbar>\\n        <ion-buttons slot=\\\"start\\\">\\n            <ion-back-button></ion-back-button>\\n        </ion-buttons>\\n        <ion-title>{{ action ? ('BACKUP_MNEMONIC' | translate) : ('EXPORT_MNEMONIC' | translate) }}</ion-title>\\n    </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n    <div class=\\\"main\\\">\\n        <div class=\\\"tips\\\" translate=\\\"\\\">BACKUP_MNEMONIC_TIPS</div>\\n        <div class=\\\"mnemonic-grid clear\\\">\\n            <div class=\\\"grid\\\" *ngFor=\\\"let mnemonic of mnemonicList\\\">\\n                {{ mnemonic }}</div>\\n        </div>\\n    </div>\\n\\n    <div class=\\\"confirm-button bottom-button\\\" tappable (click)=\\\"goNext()\\\" [ngClass]=\\\"enabled ? '' : 'disabled'\\\"\\n        translate=\\\"\\\">NEXT\\n    </div>\\n\\n</ion-content>\\n\\n\\n<div class=\\\"prompt-mask\\\" *ngIf=\\\"ifShowPasswordPrompt\\\">\\n    <div class=\\\"content\\\">\\n        <div class=\\\"desc\\\">{{ promptDesc }}</div>\\n\\n        <div class=\\\"input-password-wrapper\\\">\\n            <div class=\\\"input-wrapper\\\">\\n                <input [type]=\\\"ifEyeOpen ? 'text' : 'password'\\\" [(ngModel)]=\\\"paymentPassword\\\" placeholder=\\\"请输入您的安全密码\\\">\\n            </div>\\n            <div class=\\\"eye\\\" tappable (click)=\\\"toggleEyeOpen()\\\" [ngClass]=\\\"ifEyeOpen ? 'eye-open' : 'eye-close'\\\"></div>\\n        </div>\\n        <div class=\\\"error-text\\\" *ngIf=\\\"promptError\\\">{{ promptError }}</div>\\n\\n        <div class=\\\"btns\\\">\\n            <div class=\\\"btn btn-close\\\" tappable (click)=\\\"cancelPrompt()\\\" translate=\\\"\\\">CANCEL</div>\\n            <div class=\\\"btn btn-confirm\\\" (click)=\\\"confirmPrompt()\\\" translate=\\\"\\\">CONFIRM</div>\\n        </div>\\n    </div>\\n</div>\\n\\n<div class=\\\"lds-css ng-scope\\\" *ngIf=\\\"ifShowLoading\\\">\\n    <div class=\\\"lds-wrapper\\\">\\n        <div class=\\\"lds-flickr\\\">\\n            <div></div>\\n            <div></div>\\n            <div></div>\\n        </div>\\n        <!-- <div class=\\\"progress\\\">{{ rate }}%</div> -->\\n    </div>\\n</div>\"","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ExportMnemonicPage } from './export-mnemonic.page';\nimport { ComponentsModule } from '../../components/components.module';\nimport { TranslateModule } from \"@ngx-translate/core\";\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ExportMnemonicPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ComponentsModule,\n    TranslateModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [ExportMnemonicPage]\n})\nexport class ExportMnemonicPageModule { }\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL2V4cG9ydC1tbmVtb25pYy9leHBvcnQtbW5lbW9uaWMucGFnZS5zY3NzIn0= */\"","import { Component, OnInit } from '@angular/core';\nimport { Router, ActivatedRoute, NavigationExtras } from '@angular/router';\nimport { GlobalService } from '../../providers/global/global.service';\nimport { NativeService } from '../../providers/native/native.service';\nimport { HelperService } from '../../providers/helper/helper.service';\nimport { Platform, NavController } from '@ionic/angular';\n\n@Component({\n    selector: 'app-export-mnemonic',\n    templateUrl: './export-mnemonic.page.html',\n    styleUrls: ['./export-mnemonic.page.scss'],\n})\nexport class ExportMnemonicPage implements OnInit {\n    action = \"\";\n    enabled = false;\n    wallet;\n    ifEyeOpen = false;\n\n    mnemonicList = [];\n\n    ifShowPasswordPrompt = false;\n    paymentPassword = \"\";\n    promptDesc = \"\";\n    promptError = \"\";\n    ifShowLoading = false;\n\n    askForPassword = false;\n\n    constructor(\n        private router: Router,\n        public activeRouter: ActivatedRoute,\n        private global: GlobalService,\n        private native: NativeService,\n        private helper: HelperService,\n        private navCtrl: NavController,\n    ) {\n        if (this.router.getCurrentNavigation().extras.state) {\n            this.wallet = this.router.getCurrentNavigation().extras.state.wallet;\n            this.action = this.router.getCurrentNavigation().extras.state.action;\n            console.log(this.wallet.privateKey)\n\n            //获取助记词\n            this.mnemonicList = this.wallet.mnemonic.split(\" \");\n\n            // console.log(Buffer)\n            // try {\n            //     var key = Buffer.from(this.wallet.privateKey.replace('0x', ''), 'hex');\n            //     console.log(key)\n            //     this.keystore = JSON.stringify(EthereumWallet.fromPrivateKey(key).toV3(\"123456\", {\n            //         n: 1024\n            //     }));\n            //     console.log(this.keystore)\n            // } catch (e) {\n            //     console.log(e.message)\n            // }\n\n            // this.wallet.encrypt(\"123456\").then(res => {\n            //     console.log(\"aaaaaa\" + res)\n            //     this.keystore = res;\n            // }).catch(e => {\n            //     console.log(\"sdfsdfds\")\n            // })\n        } else {\n            //导出助记词\n            this.wallet = this.global.gWalletList[this.global.currentWalletIndex];\n            this.askForPassword = true;\n        }\n    }\n\n    async ngOnInit() {\n        let error = await this.helper.getTranslate('EXPORT_NEED_PASSEORD');\n        this.promptDesc = error\n        setTimeout(() => {\n            this.enabled = true;\n        }, 3000);\n\n        if (this.askForPassword) {\n            setTimeout(() => {\n                //需要用户输入密码\n                this.ifShowPasswordPrompt = true;\n            }, 500);\n        }\n    }\n\n    toggleEyeOpen() {\n        this.ifEyeOpen = !this.ifEyeOpen;\n    }\n\n    goNext() {\n        if (this.enabled) {\n            let navigationExtras: NavigationExtras = {\n                state: {\n                    wallet: this.wallet,\n                }\n            };\n            //前往验证页\n            this.router.navigate(['backup-mnemonic'], navigationExtras);\n        }\n    }\n\n    cancelPrompt() {\n        this.ifShowPasswordPrompt = false;\n        setTimeout(() => {\n            this.navCtrl.pop();\n        }, 50);\n    }\n\n    async confirmPrompt() {\n        this.promptError = \"\";\n        if (!this.paymentPassword) {\n            let error = await this.helper.getTranslate('PASSWORD_EMPTY');\n            this.promptError = error;\n            return;\n        }\n        this.ifShowLoading = true;\n        setTimeout(async () => {\n            //解码\n            let ret = this.helper.decryptPrivateKey(this.wallet.keystore, this.paymentPassword);\n            if (ret.flag) {\n                this.ifShowPasswordPrompt = false;\n                this.ifShowLoading = false;\n                //根据私钥生成助记词    \n                this.wallet = this.helper.generateMnemonicWallet(ret.privateKey);\n                this.mnemonicList = this.wallet.mnemonic.split(\" \");\n                return;\n            } else {\n                this.ifShowLoading = false;\n                let error = await this.helper.getTranslate('PASSEORD_ERROR');\n                this.promptError = error;\n            }\n        }, 100);\n    }\n\n}\n"],"sourceRoot":"webpack:///"}